<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
</head>
<body style="margin-top: 20px">
<div class="container">
    <div class="panel panel-default">
        <div class="panel-heading">
            <button class="btn btn-primary">进入房间A</button>
            <button class="btn btn-primary">退出房间A</button>
            <button class="btn btn-success">进入房间B</button>
            <button class="btn btn-success">退出房间B</button>
        </div>
        <div class="panel-body">
            <ul id="messages" class="list-group">
                <li class="list-group-item">张三:今天天气不错<span class="pull-right"> 2016年9月3日</span></li>
                <li class="list-group-item">李四:恩，不错<span class="pull-right"> 2016年9月3日</span></li>
            </ul>
        </div>
        <div class="panel-footer">
            <div class="row">
                <div class="col-xs-10">
                    <input onkeyup="send(event)" id="txtMsg" type="text" class="form-control">
                </div>
                <div class="col-xs-2">
                    <button onclick="talk()" class="btn btn-warning">发言</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
    //当引入socket.io脚本之后，会在window下增加一个io的属性
    window.onload = function(){
        //连接服务器
        var socket = io.connect('/');
        //监听服务器的连接成功事件
        socket.on('connect',function(){
            console.log('成功连接服务器');
        });
        //监听服务器发过来的消息 收到消息后会调用回调函数
        socket.on('message',function(msg){
            console.log(msg);
            var messages = document.querySelector('#messages');
            var li = document.createElement('li');
            li.className = 'list-group-item';
            li.innerHTML = msg;
            messages.appendChild(li);
        });

        //声明一个talk的全局变量
        window.talk = function(){
            //得到输入框的value值
            var txt = document.querySelector('#txtMsg');
            var content = txt.value;
            //把此内容通过socket发送到服务器端
            socket.send(content);
            txt.value = '';
        }
        window.send = function(event){
            //只有当按下回车键的时候才要去发言
            // which用来获取按下的是哪个键 keycode
            if(event.which == 13){
                talk();
            }
        }
    }
</script>
</html>